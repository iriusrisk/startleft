{
  "otmVersion": "0.1.0",
  "project": {
    "name": "Example Project",
    "id": "example-project"
  },
  "representations": [
    {
      "name": "Microsoft Threat Modeling Tool",
      "id": "Microsoft Threat Modeling Tool",
      "type": "threat-model"
    },
    {
      "name": "example-project Diagram Representation",
      "id": "example-project-diagram",
      "type": "diagram",
      "size": {
        "width": 2000,
        "height": 2000
      }
    }
  ],
  "trustZones": [
    {
      "id": "f0ba7722-39b6-4c81-8290-a30a248bb8d9",
      "name": "Internet",
      "risk": {
        "trustRating": 10
      },
      "properties": {
        "Name": "Internet",
        "Dataflow Order": "0"
      },
      "representations": [
        {
          "name": "Internet Representation",
          "id": "75605184-4ca0-43be-ba4c-5fa5ad15e367-representation",
          "representation": "example-project-diagram",
          "size": {
            "width": 320,
            "height": 311
          },
          "position": {
            "x": 332,
            "y": 136
          }
        }
      ]
    },
    {
      "id": "2ab4effa-40b7-4cd2-ba81-8247d29a6f2d",
      "name": "Private Secured Cloud",
      "risk": {
        "trustRating": 10
      },
      "properties": {
        "Name": "Private Secured Cloud",
        "Dataflow Order": "0"
      },
      "representations": [
        {
          "name": "Private Secured Cloud Representation",
          "id": "24cdf4da-ac7f-4a35-bab0-29256d4169bf-representation",
          "representation": "example-project-diagram",
          "size": {
            "width": 371,
            "height": 308
          },
          "position": {
            "x": 744,
            "y": 142
          }
        }
      ]
    }
  ],
  "components": [
    {
      "id": "53245f54-0656-4ede-a393-357aeaa2e20f",
      "name": "Accounting PostgreSQL",
      "type": "CD-MICROSOFT-AZURE-DB-POSTGRESQL",
      "parent": {
        "trustZone": "2ab4effa-40b7-4cd2-ba81-8247d29a6f2d"
      },
      "properties": {
        "Name": "Accounting PostgreSQL",
        "Out Of Scope": "false",
        "Azure Postgres DB Firewall Settings": "Select",
        "Azure Postgres DB TLS Enforced": "Select"
      },
      "representations": [
        {
          "name": "Accounting PostgreSQL Representation",
          "id": "53245f54-0656-4ede-a393-357aeaa2e20f-representation",
          "representation": "example-project-diagram",
          "size": {
            "width": 82,
            "height": 82
          },
          "position": {
            "x": 231,
            "y": 40
          }
        }
      ],
      "threats": [
        {
          "threat": "55",
          "state": "AutoGenerated",
          "mitigations": [
            {
              "mitigation": "55",
              "state": "RECOMMENDED"
            }
          ]
        },
        {
          "threat": "1",
          "state": "AutoGenerated",
          "mitigations": [
            {
              "mitigation": "1",
              "state": "RECOMMENDED"
            }
          ]
        },
        {
          "threat": "2",
          "state": "AutoGenerated",
          "mitigations": [
            {
              "mitigation": "2",
              "state": "RECOMMENDED"
            }
          ]
        }
      ]
    },
    {
      "id": "6183b7fa-eba5-4bf8-a0af-c3e30d144a10",
      "name": "Mobile Client",
      "type": "android-device-client",
      "parent": {
        "trustZone": "f0ba7722-39b6-4c81-8290-a30a248bb8d9"
      },
      "properties": {
        "Name": "Mobile Client",
        "Out Of Scope": "false",
        "Mobile Client Technologies": "Android"
      },
      "representations": [
        {
          "name": "Mobile Client Representation",
          "id": "6183b7fa-eba5-4bf8-a0af-c3e30d144a10-representation",
          "representation": "example-project-diagram",
          "size": {
            "width": 82,
            "height": 82
          },
          "position": {
            "x": 101,
            "y": 104
          }
        }
      ],
      "threats": [
        {
          "threat": "65",
          "state": "AutoGenerated",
          "mitigations": [
            {
              "mitigation": "65",
              "state": "RECOMMENDED"
            }
          ]
        },
        {
          "threat": "64",
          "state": "AutoGenerated",
          "mitigations": [
            {
              "mitigation": "64",
              "state": "RECOMMENDED"
            }
          ]
        }
      ]
    },
    {
      "id": "5d15323e-3729-4694-87b1-181c90af5045",
      "name": "Public API v2",
      "type": "web-service",
      "parent": {
        "trustZone": "2ab4effa-40b7-4cd2-ba81-8247d29a6f2d"
      },
      "properties": {
        "Name": "Public API v2",
        "Out Of Scope": "false",
        "Web API Technologies": "Select",
        "Hosting environment": "Select",
        "Identity Provider": "Select"
      },
      "representations": [
        {
          "name": "Public API v2 Representation",
          "id": "5d15323e-3729-4694-87b1-181c90af5045-representation",
          "representation": "example-project-diagram",
          "size": {
            "width": 82,
            "height": 82
          },
          "position": {
            "x": 21,
            "y": 101
          }
        }
      ],
      "threats": [
        {
          "threat": "3",
          "state": "AutoGenerated",
          "mitigations": [
            {
              "mitigation": "3",
              "state": "RECOMMENDED"
            }
          ]
        },
        {
          "threat": "4",
          "state": "AutoGenerated",
          "mitigations": [
            {
              "mitigation": "4",
              "state": "RECOMMENDED"
            }
          ]
        },
        {
          "threat": "5",
          "state": "AutoGenerated",
          "mitigations": [
            {
              "mitigation": "5",
              "state": "RECOMMENDED"
            }
          ]
        },
        {
          "threat": "6",
          "state": "AutoGenerated",
          "mitigations": [
            {
              "mitigation": "6",
              "state": "RECOMMENDED"
            }
          ]
        },
        {
          "threat": "7",
          "state": "AutoGenerated",
          "mitigations": [
            {
              "mitigation": "7",
              "state": "RECOMMENDED"
            }
          ]
        },
        {
          "threat": "8",
          "state": "AutoGenerated",
          "mitigations": [
            {
              "mitigation": "8",
              "state": "RECOMMENDED"
            }
          ]
        },
        {
          "threat": "9",
          "state": "AutoGenerated",
          "mitigations": [
            {
              "mitigation": "9",
              "state": "RECOMMENDED"
            }
          ]
        },
        {
          "threat": "10",
          "state": "AutoGenerated",
          "mitigations": [
            {
              "mitigation": "10",
              "state": "RECOMMENDED"
            }
          ]
        },
        {
          "threat": "62",
          "state": "AutoGenerated",
          "mitigations": [
            {
              "mitigation": "62",
              "state": "RECOMMENDED"
            }
          ]
        },
        {
          "threat": "61",
          "state": "AutoGenerated",
          "mitigations": [
            {
              "mitigation": "61",
              "state": "RECOMMENDED"
            }
          ]
        },
        {
          "threat": "60",
          "state": "AutoGenerated",
          "mitigations": [
            {
              "mitigation": "60",
              "state": "RECOMMENDED"
            }
          ]
        },
        {
          "threat": "59",
          "state": "AutoGenerated",
          "mitigations": [
            {
              "mitigation": "59",
              "state": "RECOMMENDED"
            }
          ]
        },
        {
          "threat": "58",
          "state": "AutoGenerated",
          "mitigations": [
            {
              "mitigation": "58",
              "state": "RECOMMENDED"
            }
          ]
        },
        {
          "threat": "57",
          "state": "AutoGenerated",
          "mitigations": [
            {
              "mitigation": "57",
              "state": "RECOMMENDED"
            }
          ]
        },
        {
          "threat": "56",
          "state": "AutoGenerated",
          "mitigations": [
            {
              "mitigation": "56",
              "state": "RECOMMENDED"
            }
          ]
        },
        {
          "threat": "25",
          "state": "AutoGenerated",
          "mitigations": [
            {
              "mitigation": "25",
              "state": "RECOMMENDED"
            }
          ]
        },
        {
          "threat": "26",
          "state": "AutoGenerated",
          "mitigations": [
            {
              "mitigation": "26",
              "state": "RECOMMENDED"
            }
          ]
        },
        {
          "threat": "27",
          "state": "AutoGenerated",
          "mitigations": [
            {
              "mitigation": "27",
              "state": "RECOMMENDED"
            }
          ]
        },
        {
          "threat": "28",
          "state": "AutoGenerated",
          "mitigations": [
            {
              "mitigation": "28",
              "state": "RECOMMENDED"
            }
          ]
        },
        {
          "threat": "29",
          "state": "AutoGenerated",
          "mitigations": [
            {
              "mitigation": "29",
              "state": "RECOMMENDED"
            }
          ]
        },
        {
          "threat": "30",
          "state": "AutoGenerated",
          "mitigations": [
            {
              "mitigation": "30",
              "state": "RECOMMENDED"
            }
          ]
        },
        {
          "threat": "31",
          "state": "AutoGenerated",
          "mitigations": [
            {
              "mitigation": "31",
              "state": "RECOMMENDED"
            }
          ]
        },
        {
          "threat": "32",
          "state": "AutoGenerated",
          "mitigations": [
            {
              "mitigation": "32",
              "state": "RECOMMENDED"
            }
          ]
        },
        {
          "threat": "33",
          "state": "AutoGenerated",
          "mitigations": [
            {
              "mitigation": "33",
              "state": "RECOMMENDED"
            }
          ]
        },
        {
          "threat": "34",
          "state": "AutoGenerated",
          "mitigations": [
            {
              "mitigation": "34",
              "state": "RECOMMENDED"
            }
          ]
        },
        {
          "threat": "35",
          "state": "AutoGenerated",
          "mitigations": [
            {
              "mitigation": "35",
              "state": "RECOMMENDED"
            }
          ]
        },
        {
          "threat": "36",
          "state": "AutoGenerated",
          "mitigations": [
            {
              "mitigation": "36",
              "state": "RECOMMENDED"
            }
          ]
        },
        {
          "threat": "37",
          "state": "AutoGenerated",
          "mitigations": [
            {
              "mitigation": "37",
              "state": "RECOMMENDED"
            }
          ]
        },
        {
          "threat": "38",
          "state": "AutoGenerated",
          "mitigations": [
            {
              "mitigation": "38",
              "state": "RECOMMENDED"
            }
          ]
        },
        {
          "threat": "39",
          "state": "AutoGenerated",
          "mitigations": [
            {
              "mitigation": "39",
              "state": "RECOMMENDED"
            }
          ]
        },
        {
          "threat": "63",
          "state": "AutoGenerated",
          "mitigations": [
            {
              "mitigation": "63",
              "state": "RECOMMENDED"
            }
          ]
        }
      ]
    },
    {
      "id": "91882aca-8249-49a7-96f0-164b68411b48",
      "name": "Azure File Storage",
      "type": "azure-storage",
      "parent": {
        "trustZone": "2ab4effa-40b7-4cd2-ba81-8247d29a6f2d"
      },
      "properties": {
        "Name": "Azure File Storage",
        "Out Of Scope": "false",
        "Storage Type": "Select",
        "HTTPS Enforced": "Select",
        "Network Security": "Select",
        "CORS Enabled": "Select"
      },
      "representations": [
        {
          "name": "Azure File Storage Representation",
          "id": "91882aca-8249-49a7-96f0-164b68411b48-representation",
          "representation": "example-project-diagram",
          "size": {
            "width": 82,
            "height": 82
          },
          "position": {
            "x": 230,
            "y": 169
          }
        }
      ],
      "threats": [
        {
          "threat": "11",
          "state": "AutoGenerated",
          "mitigations": [
            {
              "mitigation": "11",
              "state": "RECOMMENDED"
            }
          ]
        },
        {
          "threat": "12",
          "state": "AutoGenerated",
          "mitigations": [
            {
              "mitigation": "12",
              "state": "RECOMMENDED"
            }
          ]
        },
        {
          "threat": "13",
          "state": "AutoGenerated",
          "mitigations": [
            {
              "mitigation": "13",
              "state": "RECOMMENDED"
            }
          ]
        },
        {
          "threat": "14",
          "state": "AutoGenerated",
          "mitigations": [
            {
              "mitigation": "14",
              "state": "RECOMMENDED"
            }
          ]
        },
        {
          "threat": "15",
          "state": "AutoGenerated",
          "mitigations": [
            {
              "mitigation": "15",
              "state": "RECOMMENDED"
            }
          ]
        },
        {
          "threat": "16",
          "state": "AutoGenerated",
          "mitigations": [
            {
              "mitigation": "16",
              "state": "RECOMMENDED"
            }
          ]
        },
        {
          "threat": "17",
          "state": "AutoGenerated",
          "mitigations": [
            {
              "mitigation": "17",
              "state": "RECOMMENDED"
            }
          ]
        }
      ]
    }
  ],
  "dataflows": [
    {
      "id": "eb072144-af37-4b75-b46b-b78111850d3e",
      "name": "PSQL Request",
      "source": "5d15323e-3729-4694-87b1-181c90af5045",
      "destination": "53245f54-0656-4ede-a393-357aeaa2e20f",
      "bidirectional": false,
      "properties": {
        "Request": {},
        "Name": "PSQL Request",
        "Dataflow Order": "0",
        "Out Of Scope": "false",
        "Reason For Out Of Scope": {},
        "Configurable Attributes": {},
        "As Generic Data Flow": {},
        "Show Boundary Threats": "Select"
      }
    },
    {
      "id": "36091fd8-dba8-424e-a3cd-784ea6bcb9e0",
      "name": "PSQL Response",
      "source": "53245f54-0656-4ede-a393-357aeaa2e20f",
      "destination": "5d15323e-3729-4694-87b1-181c90af5045",
      "bidirectional": false,
      "properties": {
        "Response": {},
        "Name": "PSQL Response",
        "Dataflow Order": "0",
        "Out Of Scope": "false",
        "Reason For Out Of Scope": {},
        "Configurable Attributes": {},
        "As Generic Data Flow": {},
        "Show Boundary Threats": "Select"
      }
    },
    {
      "id": "f5fe3c6e-e10b-4252-a4aa-4ec6108c96a6",
      "name": "File Request",
      "source": "5d15323e-3729-4694-87b1-181c90af5045",
      "destination": "91882aca-8249-49a7-96f0-164b68411b48",
      "bidirectional": false,
      "properties": {
        "Request": {},
        "Name": "File Request",
        "Dataflow Order": "0",
        "Out Of Scope": "false",
        "Reason For Out Of Scope": {},
        "Configurable Attributes": {},
        "As Generic Data Flow": {},
        "Show Boundary Threats": "Select"
      }
    },
    {
      "id": "d826de3d-1464-4d1f-8105-aa0449a50aec",
      "name": "File Response",
      "source": "91882aca-8249-49a7-96f0-164b68411b48",
      "destination": "5d15323e-3729-4694-87b1-181c90af5045",
      "bidirectional": false,
      "properties": {
        "Response": {},
        "Name": "File Response",
        "Dataflow Order": "0",
        "Out Of Scope": "false",
        "Reason For Out Of Scope": {},
        "Configurable Attributes": {},
        "As Generic Data Flow": {},
        "Show Boundary Threats": "Select"
      }
    },
    {
      "id": "9840bcdf-c444-437d-8289-d5468f41b0db",
      "name": "API Request",
      "source": "6183b7fa-eba5-4bf8-a0af-c3e30d144a10",
      "destination": "5d15323e-3729-4694-87b1-181c90af5045",
      "bidirectional": false,
      "properties": {
        "Request": {},
        "Name": "API Request",
        "Dataflow Order": "0",
        "Out Of Scope": "false",
        "Reason For Out Of Scope": {},
        "Configurable Attributes": {},
        "As Generic Data Flow": {},
        "Show Boundary Threats": "Select"
      }
    },
    {
      "id": "5861370d-b333-4d4b-9420-95425026e9c9",
      "name": "API Response",
      "source": "5d15323e-3729-4694-87b1-181c90af5045",
      "destination": "6183b7fa-eba5-4bf8-a0af-c3e30d144a10",
      "bidirectional": false,
      "properties": {
        "Response": {},
        "Name": "API Response",
        "Dataflow Order": "0",
        "Out Of Scope": "false",
        "Reason For Out Of Scope": {},
        "Configurable Attributes": {},
        "As Generic Data Flow": {},
        "Show Boundary Threats": "Select"
      }
    }
  ],
  "threats": [
    {
      "name": "An adversary can gain unauthorized access to Azure Postgres DB instances due to weak network security configuration",
      "id": "55",
      "categories": [
        "Elevation of Privileges"
      ],
      "risk": {
        "likelihood": 100,
        "impact": 100
      },
      "description": "An adversary can gain unauthorized access to  Accounting PostgreSQL instances due to weak network security configuration"
    },
    {
      "name": "An adversary may read and/or tamper with the data transmitted to Azure Postgres DB due to weak configuration",
      "id": "1",
      "categories": [
        "Tampering"
      ],
      "risk": {
        "likelihood": 100,
        "impact": 100
      },
      "description": "An adversary may read and/or tamper with the data transmitted to Accounting PostgreSQL due to weak configuration"
    },
    {
      "name": "An adversary can gain long term, persistent access to an Azure Postgres DB instance through the compromise of local user account password(s)",
      "id": "2",
      "categories": [
        "Elevation of Privileges"
      ],
      "risk": {
        "likelihood": 100,
        "impact": 100
      },
      "description": "An adversary can gain long term, persistent access to Accounting PostgreSQL instance through the compromise of local user account password(s)"
    },
    {
      "name": "An adversary may gain unauthorized access to Web API due to poor access control checks",
      "id": "3",
      "categories": [
        "Elevation of Privileges"
      ],
      "risk": {
        "likelihood": 100,
        "impact": 100
      },
      "description": "An adversary may gain unauthorized access to Web API due to poor access control checks"
    },
    {
      "name": "An adversary can gain access to sensitive information from an API through error messages",
      "id": "4",
      "categories": [
        "Information Disclosure"
      ],
      "risk": {
        "likelihood": 100,
        "impact": 100
      },
      "description": "An adversary can gain access to sensitive data such as the following, through verbose error messages - Server names - Connection strings - Usernames - Passwords - SQL procedures - Details of dynamic SQL failures - Stack trace and lines of code - Variables stored in memory - Drive and folder locations - Application install points - Host configuration settings - Other internal application details"
    },
    {
      "name": "An adversary can gain access to sensitive data by sniffing traffic to Web API",
      "id": "5",
      "categories": [
        "Information Disclosure"
      ],
      "risk": {
        "likelihood": 100,
        "impact": 100
      },
      "description": "An adversary can gain access to sensitive data by sniffing traffic to Web API"
    },
    {
      "name": "An adversary can gain access to sensitive data stored in Web API's config files",
      "id": "6",
      "categories": [
        "Information Disclosure"
      ],
      "risk": {
        "likelihood": 100,
        "impact": 100
      },
      "description": "An adversary can gain access to the config files. and if sensitive data is stored in it, it would be compromised"
    },
    {
      "name": "Attacker can deny a malicious act on an API leading to repudiation issues",
      "id": "7",
      "categories": [
        "Repudiation"
      ],
      "risk": {
        "likelihood": 100,
        "impact": 100
      },
      "description": "Attacker can deny a malicious act on an API leading to repudiation issues"
    },
    {
      "name": "An adversary may spoof Accounting PostgreSQL and gain access to Web API",
      "id": "8",
      "categories": [
        "Spoofing"
      ],
      "risk": {
        "likelihood": 100,
        "impact": 100
      },
      "description": "If proper authentication is not in place, an adversary can spoof a source process or external entity and gain unauthorized access to the Web Application"
    },
    {
      "name": "An adversary may inject malicious inputs into an API and affect downstream processes",
      "id": "9",
      "categories": [
        "Tampering"
      ],
      "risk": {
        "likelihood": 100,
        "impact": 100
      },
      "description": "An adversary may inject malicious inputs into an API and affect downstream processes"
    },
    {
      "name": "An adversary can gain access to sensitive data by performing SQL injection through Web API",
      "id": "10",
      "categories": [
        "Tampering"
      ],
      "risk": {
        "likelihood": 100,
        "impact": 100
      },
      "description": "SQL injection is an attack in which malicious code is inserted into strings that are later passed to an instance of SQL Server for parsing and execution. The primary form of SQL injection consists of direct insertion of code into user-input variables that are concatenated with SQL commands and executed. A less direct attack injects malicious code into strings that are destined for storage in a table or as metadata. When the stored strings are subsequently concatenated into a dynamic SQL command, the malicious code is executed"
    },
    {
      "name": "An adversary can gain unauthorized access to Azure File Storage due to weak access control restrictions",
      "id": "11",
      "categories": [
        "Elevation of Privileges"
      ],
      "risk": {
        "likelihood": 100,
        "impact": 100
      },
      "description": "An adversary can gain unauthorized access to Azure File Storage due to weak access control restrictions"
    },
    {
      "name": "An adversary can gain unauthorized access to Azure File Storage instances due to weak network configuration",
      "id": "12",
      "categories": [
        "Elevation of Privileges"
      ],
      "risk": {
        "likelihood": 100,
        "impact": 100
      },
      "description": "An adversary can gain unauthorized access to Azure File Storage instances due to weak network configuration"
    },
    {
      "name": "An adversary may gain unauthorized access to Azure File Storage account in a subscription",
      "id": "13",
      "categories": [
        "Elevation of Privileges"
      ],
      "risk": {
        "likelihood": 100,
        "impact": 100
      },
      "description": "An adversary may gain unauthorized access to Azure File Storage account in a subscription"
    },
    {
      "name": "An adversary can abuse poorly managed Azure File Storage account access keys",
      "id": "14",
      "categories": [
        "Elevation of Privileges"
      ],
      "risk": {
        "likelihood": 100,
        "impact": 100
      },
      "description": "An adversary can abuse poorly managed Azure File Storage account access keys and gain unauthorized access to storage"
    },
    {
      "name": "An adversary can abuse an insecure communication channel between a client and Azure File Storage",
      "id": "15",
      "categories": [
        "Information Disclosure"
      ],
      "risk": {
        "likelihood": 100,
        "impact": 100
      },
      "description": "An adversary can abuse an insecure communication channel between a client and Azure File Storage"
    },
    {
      "name": "An adversary can deny actions on Azure File Storage due to lack of auditing",
      "id": "16",
      "categories": [
        "Repudiation"
      ],
      "risk": {
        "likelihood": 100,
        "impact": 100
      },
      "description": "Proper logging of all security events and user actions builds traceability in a system and denies any possible repudiation issues. In the absence of proper auditing and logging controls, it would become impossible to implement any accountability in a system"
    },
    {
      "name": "An adversary can gain unauthorized access to Azure File Storage due to weak CORS configuration",
      "id": "17",
      "categories": [
        "Elevation of Privileges"
      ],
      "risk": {
        "likelihood": 100,
        "impact": 100
      },
      "description": "An adversary can gain unauthorized access to Azure File Storage due to weak CORS configuration"
    },
    {
      "name": "An adversary may inject malicious inputs into an API and affect downstream processes",
      "id": "62",
      "categories": [
        "Tampering"
      ],
      "risk": {
        "likelihood": 100,
        "impact": 100
      },
      "description": "An adversary may inject malicious inputs into an API and affect downstream processes"
    },
    {
      "name": "An adversary may spoof Azure File Storage and gain access to Web API",
      "id": "61",
      "categories": [
        "Spoofing"
      ],
      "risk": {
        "likelihood": 100,
        "impact": 100
      },
      "description": "If proper authentication is not in place, an adversary can spoof a source process or external entity and gain unauthorized access to the Web Application"
    },
    {
      "name": "Attacker can deny a malicious act on an API leading to repudiation issues",
      "id": "60",
      "categories": [
        "Repudiation"
      ],
      "risk": {
        "likelihood": 100,
        "impact": 100
      },
      "description": "Attacker can deny a malicious act on an API leading to repudiation issues"
    },
    {
      "name": "An adversary can gain access to sensitive data stored in Web API's config files",
      "id": "59",
      "categories": [
        "Information Disclosure"
      ],
      "risk": {
        "likelihood": 100,
        "impact": 100
      },
      "description": "An adversary can gain access to the config files. and if sensitive data is stored in it, it would be compromised"
    },
    {
      "name": "An adversary can gain access to sensitive data by sniffing traffic to Web API",
      "id": "58",
      "categories": [
        "Information Disclosure"
      ],
      "risk": {
        "likelihood": 100,
        "impact": 100
      },
      "description": "An adversary can gain access to sensitive data by sniffing traffic to Web API"
    },
    {
      "name": "An adversary can gain access to sensitive information from an API through error messages",
      "id": "57",
      "categories": [
        "Information Disclosure"
      ],
      "risk": {
        "likelihood": 100,
        "impact": 100
      },
      "description": "An adversary can gain access to sensitive data such as the following, through verbose error messages - Server names - Connection strings - Usernames - Passwords - SQL procedures - Details of dynamic SQL failures - Stack trace and lines of code - Variables stored in memory - Drive and folder locations - Application install points - Host configuration settings - Other internal application details"
    },
    {
      "name": "An adversary may gain unauthorized access to Web API due to poor access control checks",
      "id": "56",
      "categories": [
        "Elevation of Privileges"
      ],
      "risk": {
        "likelihood": 100,
        "impact": 100
      },
      "description": "An adversary may gain unauthorized access to Web API due to poor access control checks"
    },
    {
      "name": "An adversary may jail break into a mobile device and gain elevated privileges",
      "id": "25",
      "categories": [
        "Elevation of Privileges"
      ],
      "risk": {
        "likelihood": 100,
        "impact": 100
      },
      "description": "An adversary may jail break into a mobile device and gain elevated privileges"
    },
    {
      "name": "An adversary may gain unauthorized access to Web API due to poor access control checks",
      "id": "26",
      "categories": [
        "Elevation of Privileges"
      ],
      "risk": {
        "likelihood": 100,
        "impact": 100
      },
      "description": "An adversary may gain unauthorized access to Web API due to poor access control checks"
    },
    {
      "name": "An adversary can gain unauthorized access to resources in an Azure subscription",
      "id": "27",
      "categories": [
        "Elevation of Privileges"
      ],
      "risk": {
        "likelihood": 100,
        "impact": 100
      },
      "description": "An adversary can gain unauthorized access to resources in Azure subscription. The adversary can be either a disgruntled internal user, or someone who has stolen the credentials of an Azure subscription"
    },
    {
      "name": "An adversary can gain access to sensitive information from an API through error messages",
      "id": "28",
      "categories": [
        "Information Disclosure"
      ],
      "risk": {
        "likelihood": 100,
        "impact": 100
      },
      "description": "An adversary can gain access to sensitive data such as the following, through verbose error messages - Server names - Connection strings - Usernames - Passwords - SQL procedures - Details of dynamic SQL failures - Stack trace and lines of code - Variables stored in memory - Drive and folder locations - Application install points - Host configuration settings - Other internal application details"
    },
    {
      "name": "An adversary can gain access to sensitive data by sniffing traffic from Mobile client",
      "id": "29",
      "categories": [
        "Information Disclosure"
      ],
      "risk": {
        "likelihood": 100,
        "impact": 100
      },
      "description": "An adversary can gain access to sensitive data by sniffing traffic from Mobile client"
    },
    {
      "name": "An adversary can gain access to sensitive data by sniffing traffic to Web API",
      "id": "30",
      "categories": [
        "Information Disclosure"
      ],
      "risk": {
        "likelihood": 100,
        "impact": 100
      },
      "description": "An adversary can gain access to sensitive data by sniffing traffic to Web API"
    },
    {
      "name": "An adversary can gain sensitive data from mobile device",
      "id": "31",
      "categories": [
        "Information Disclosure"
      ],
      "risk": {
        "likelihood": 100,
        "impact": 100
      },
      "description": "If application saves sensitive PII or HBI data on phone SD card or local storage, then it ay get stolen"
    },
    {
      "name": "An adversary can gain access to sensitive data stored in Web API's config files",
      "id": "32",
      "categories": [
        "Information Disclosure"
      ],
      "risk": {
        "likelihood": 100,
        "impact": 100
      },
      "description": "An adversary can gain access to the config files. and if sensitive data is stored in it, it would be compromised"
    },
    {
      "name": "Attacker can deny a malicious act on an API leading to repudiation issues",
      "id": "33",
      "categories": [
        "Repudiation"
      ],
      "risk": {
        "likelihood": 100,
        "impact": 100
      },
      "description": "Attacker can deny a malicious act on an API leading to repudiation issues"
    },
    {
      "name": "An adversary may spoof an Azure administrator and gain access to Azure subscription portal",
      "id": "34",
      "categories": [
        "Spoofing"
      ],
      "risk": {
        "likelihood": 100,
        "impact": 100
      },
      "description": "An adversary may spoof an Azure administrator and gain access to Azure subscription portal if the administrator's credentials are compromised"
    },
    {
      "name": "An adversary obtains refresh or access tokens from Mobile Client and uses them to obtain access to the Public API v2 API",
      "id": "35",
      "categories": [
        "Spoofing"
      ],
      "risk": {
        "likelihood": 100,
        "impact": 100
      },
      "description": "On a public client (e.g. a mobile device), refresh tokens may be stolen and used by an attacker to obtain access to the API. Depending on the client type, there are different ways that tokens may be revealed to an attacker and therefore different ways to protect them, some involving how the software using the tokens requests, stores and refreshes them"
    },
    {
      "name": "An adversary may spoof Mobile Client and gain access to Web API",
      "id": "36",
      "categories": [
        "Spoofing"
      ],
      "risk": {
        "likelihood": 100,
        "impact": 100
      },
      "description": "If proper authentication is not in place, an adversary can spoof a source process or external entity and gain unauthorized access to the Web Application"
    },
    {
      "name": "An adversary may inject malicious inputs into an API and affect downstream processes",
      "id": "37",
      "categories": [
        "Tampering"
      ],
      "risk": {
        "likelihood": 100,
        "impact": 100
      },
      "description": "An adversary may inject malicious inputs into an API and affect downstream processes"
    },
    {
      "name": "An adversary can reverse engineer and tamper binaries",
      "id": "38",
      "categories": [
        "Tampering"
      ],
      "risk": {
        "likelihood": 100,
        "impact": 100
      },
      "description": "An adversary can use various tools, reverse engineer binaries and abuse them by tampering"
    },
    {
      "name": "An adversary can gain access to sensitive data by performing SQL injection through Web API",
      "id": "39",
      "categories": [
        "Tampering"
      ],
      "risk": {
        "likelihood": 100,
        "impact": 100
      },
      "description": "SQL injection is an attack in which malicious code is inserted into strings that are later passed to an instance of SQL Server for parsing and execution. The primary form of SQL injection consists of direct insertion of code into user-input variables that are concatenated with SQL commands and executed. A less direct attack injects malicious code into strings that are destined for storage in a table or as metadata. When the stored strings are subsequently concatenated into a dynamic SQL command, the malicious code is executed"
    },
    {
      "name": "An adversary may spoof an Azure administrator and gain access to Azure subscription portal",
      "id": "65",
      "categories": [
        "Spoofing"
      ],
      "risk": {
        "likelihood": 100,
        "impact": 100
      },
      "description": "An adversary may spoof an Azure administrator and gain access to Azure subscription portal if the administrator's credentials are compromised"
    },
    {
      "name": "An adversary can gain unauthorized access to resources in an Azure subscription",
      "id": "64",
      "categories": [
        "Elevation of Privileges"
      ],
      "risk": {
        "likelihood": 100,
        "impact": 100
      },
      "description": "An adversary can gain unauthorized access to resources in Azure subscription. The adversary can be either a disgruntled internal user, or someone who has stolen the credentials of an Azure subscription"
    },
    {
      "name": "An adversary can gain access to sensitive data by performing SQL injection through Web API",
      "id": "63",
      "categories": [
        "Tampering"
      ],
      "risk": {
        "likelihood": 100,
        "impact": 100
      },
      "description": "SQL injection is an attack in which malicious code is inserted into strings that are later passed to an instance of SQL Server for parsing and execution. The primary form of SQL injection consists of direct insertion of code into user-input variables that are concatenated with SQL commands and executed. A less direct attack injects malicious code into strings that are destined for storage in a table or as metadata. When the stored strings are subsequently concatenated into a dynamic SQL command, the malicious code is executed"
    }
  ],
  "mitigations": [
    {
      "name": "Restrict access to Azure Postgres DB instances by configuring server-level firewall rules to only permit connections from selected IP addresses where possible",
      "id": "55",
      "riskReduction": 100,
      "description": "Restrict access to Azure Postgres DB instances by configuring server-level firewall rules to only permit connections from selected IP addresses where possible. Refer: <a href=\"https://aka.ms/tmt-th153\">https://aka.ms/tmt-th153</a>"
    },
    {
      "name": "Enforce communication between clients and Azure Postgres DB to be over SSL/TLS by enabling the Enforce SSL connection feature on the server",
      "id": "1",
      "riskReduction": 100,
      "description": "Enforce communication between clients and Azure Postgres DB to be over SSL/TLS by enabling the Enforce SSL connection feature on the server. Check that the connection strings used to connect to MySQL databases have the right configuration (e.g. ssl = true or sslmode=require or sslmode=true are set). Refer: <a href=\"https://aka.ms/tmt-th154a\">https://aka.ms/tmt-th154a</a> Configure MySQL server to use a verifiable SSL certificate (needed for SSL/TLS communication). Refer: <a href=\"https://aka.ms/tmt-th154b\">https://aka.ms/tmt-th154b</a>"
    },
    {
      "name": "It is recommended to rotate user account passwords (e",
      "id": "2",
      "riskReduction": 100,
      "description": "It is recommended to rotate user account passwords (e.g. those used in connection strings) regularly, in accordance with your organization's policies. Store secrets in a secret storage solution (e.g. Azure Key Vault)"
    },
    {
      "name": "Implement proper authorization mechanism in ASP",
      "id": "3",
      "riskReduction": 100,
      "description": "Implement proper authorization mechanism in ASP.NET Web API. Refer: <a href=\"https://aka.ms/tmtauthz#authz-aspnet\">https://aka.ms/tmtauthz#authz-aspnet</a>"
    },
    {
      "name": "Ensure that proper exception handling is done in ASP",
      "id": "4",
      "riskReduction": 100,
      "description": "Ensure that proper exception handling is done in ASP.NET Web API. Refer: <a href=\"https://aka.ms/tmtxmgmt#exception\">https://aka.ms/tmtxmgmt#exception</a>"
    },
    {
      "name": "Force all traffic to Web APIs over HTTPS connection",
      "id": "5",
      "riskReduction": 100,
      "description": "Force all traffic to Web APIs over HTTPS connection. Refer: <a href=\"https://aka.ms/tmtcommsec#webapi-https\">https://aka.ms/tmtcommsec#webapi-https</a>"
    },
    {
      "name": "Encrypt sections of Web API's configuration files that contain sensitive data",
      "id": "6",
      "riskReduction": 100,
      "description": "Encrypt sections of Web API's configuration files that contain sensitive data. Refer: <a href=\"https://aka.ms/tmtconfigmgmt#config-sensitive\">https://aka.ms/tmtconfigmgmt#config-sensitive</a>"
    },
    {
      "name": "Ensure that auditing and logging is enforced on Web API",
      "id": "7",
      "riskReduction": 100,
      "description": "Ensure that auditing and logging is enforced on Web API. Refer: <a href=\"https://aka.ms/tmtauditlog#logging-web-api\">https://aka.ms/tmtauditlog#logging-web-api</a>"
    },
    {
      "name": "Ensure that standard authentication techniques are used to secure Web APIs",
      "id": "8",
      "riskReduction": 100,
      "description": "Ensure that standard authentication techniques are used to secure Web APIs. Refer: <a href=\"https://aka.ms/tmtauthn#authn-secure-api\">https://aka.ms/tmtauthn#authn-secure-api</a>"
    },
    {
      "name": "Ensure that model validation is done on Web API methods",
      "id": "9",
      "riskReduction": 100,
      "description": "Ensure that model validation is done on Web API methods. Refer: <a href=\"https://aka.ms/tmtinputval#validation-api\">https://aka.ms/tmtinputval#validation-api</a>  Implement input validation on all string type parameters accepted by Web API methods. Refer: <a href=\"https://aka.ms/tmtinputval#string-api\">https://aka.ms/tmtinputval#string-api</a>"
    },
    {
      "name": "Ensure that type-safe parameters are used in Web API for data access",
      "id": "10",
      "riskReduction": 100,
      "description": "Ensure that type-safe parameters are used in Web API for data access. Refer: <a href=\"https://aka.ms/tmtinputval#typesafe-api\">https://aka.ms/tmtinputval#typesafe-api</a>"
    },
    {
      "name": "Grant limited access to objects in Azure Storage using SAS or SAP",
      "id": "11",
      "riskReduction": 100,
      "description": "Grant limited access to objects in Azure Storage using SAS or SAP. It is recommended to scope SAS and SAP to permit only the necessary permissions over a short period of time. Refer: <a href=\"https://aka.ms/tmt-th17a\">https://aka.ms/tmt-th17a</a> and <a href=\"https://aka.ms/tmt-th17b\">https://aka.ms/tmt-th17b</a>"
    },
    {
      "name": "It is recommended to restrict access to Azure Storage instances to selected networks where possible",
      "id": "12",
      "riskReduction": 100,
      "description": "It is recommended to restrict access to Azure Storage instances to selected networks where possible. <a href=\"https://aka.ms/tmt-th140\">https://aka.ms/tmt-th140</a>"
    },
    {
      "name": "Assign the appropriate Role-Based Access Control (RBAC) role to users, groups and applications at the right scope for the Azure Storage instance",
      "id": "13",
      "riskReduction": 100,
      "description": "Assign the appropriate Role-Based Access Control (RBAC) role to users, groups and applications at the right scope for the Azure Storage instance. Refer: <a href=\"https://aka.ms/tmt-th67\">https://aka.ms/tmt-th67</a>"
    },
    {
      "name": "Ensure secure management and storage of Azure storage access keys",
      "id": "14",
      "riskReduction": 100,
      "description": "Ensure secure management and storage of Azure storage access keys. It is recommended to rotate storage access keys regularly, in accordance with organizational policies. Refer: <a href=\"https://aka.ms/tmt-th63\">https://aka.ms/tmt-th63</a>"
    },
    {
      "name": "Ensure that communication to Azure Storage is over HTTPS",
      "id": "15",
      "riskReduction": 100,
      "description": "Ensure that communication to Azure Storage is over HTTPS. It is recommended to enable the secure transfer required option to force communication with Azure Storage to be over HTTPS.  Use Client-Side Encryption to store sensitive data in Azure Storage. Refer: <a href=\"https://aka.ms/tmt-th65\">https://aka.ms/tmt-th65</a>"
    },
    {
      "name": "Use Azure Storage Analytics to audit access of Azure Storage",
      "id": "16",
      "riskReduction": 100,
      "description": "Use Azure Storage Analytics to audit access of Azure Storage. If possible, audit the calls to the Azure Storage instance at the source of the call. Refer: <a href=\"https://aka.ms/tmt-th20\">https://aka.ms/tmt-th20</a>"
    },
    {
      "name": "Ensure that only specific, trusted origins are allowed",
      "id": "17",
      "riskReduction": 100,
      "description": "Ensure that only specific, trusted origins are allowed. Refer: <a href=\"https://aka.ms/tmt-th21\">https://aka.ms/tmt-th21</a>"
    },
    {
      "name": "Ensure that model validation is done on Web API methods",
      "id": "62",
      "riskReduction": 100,
      "description": "Ensure that model validation is done on Web API methods. Refer: <a href=\"https://aka.ms/tmtinputval#validation-api\">https://aka.ms/tmtinputval#validation-api</a>  Implement input validation on all string type parameters accepted by Web API methods. Refer: <a href=\"https://aka.ms/tmtinputval#string-api\">https://aka.ms/tmtinputval#string-api</a>"
    },
    {
      "name": "Ensure that standard authentication techniques are used to secure Web APIs",
      "id": "61",
      "riskReduction": 100,
      "description": "Ensure that standard authentication techniques are used to secure Web APIs. Refer: <a href=\"https://aka.ms/tmtauthn#authn-secure-api\">https://aka.ms/tmtauthn#authn-secure-api</a>"
    },
    {
      "name": "Ensure that auditing and logging is enforced on Web API",
      "id": "60",
      "riskReduction": 100,
      "description": "Ensure that auditing and logging is enforced on Web API. Refer: <a href=\"https://aka.ms/tmtauditlog#logging-web-api\">https://aka.ms/tmtauditlog#logging-web-api</a>"
    },
    {
      "name": "Encrypt sections of Web API's configuration files that contain sensitive data",
      "id": "59",
      "riskReduction": 100,
      "description": "Encrypt sections of Web API's configuration files that contain sensitive data. Refer: <a href=\"https://aka.ms/tmtconfigmgmt#config-sensitive\">https://aka.ms/tmtconfigmgmt#config-sensitive</a>"
    },
    {
      "name": "Force all traffic to Web APIs over HTTPS connection",
      "id": "58",
      "riskReduction": 100,
      "description": "Force all traffic to Web APIs over HTTPS connection. Refer: <a href=\"https://aka.ms/tmtcommsec#webapi-https\">https://aka.ms/tmtcommsec#webapi-https</a>"
    },
    {
      "name": "Ensure that proper exception handling is done in ASP",
      "id": "57",
      "riskReduction": 100,
      "description": "Ensure that proper exception handling is done in ASP.NET Web API. Refer: <a href=\"https://aka.ms/tmtxmgmt#exception\">https://aka.ms/tmtxmgmt#exception</a>"
    },
    {
      "name": "Implement proper authorization mechanism in ASP",
      "id": "56",
      "riskReduction": 100,
      "description": "Implement proper authorization mechanism in ASP.NET Web API. Refer: <a href=\"https://aka.ms/tmtauthz#authz-aspnet\">https://aka.ms/tmtauthz#authz-aspnet</a>"
    },
    {
      "name": "Implement implicit jailbreak or rooting detection",
      "id": "25",
      "riskReduction": 100,
      "description": "Implement implicit jailbreak or rooting detection. Refer: <a href=\"https://aka.ms/tmtauthz#rooting-detection\">https://aka.ms/tmtauthz#rooting-detection</a>"
    },
    {
      "name": "Implement proper authorization mechanism in ASP",
      "id": "26",
      "riskReduction": 100,
      "description": "Implement proper authorization mechanism in ASP.NET Web API. Refer: <a href=\"https://aka.ms/tmtauthz#authz-aspnet\">https://aka.ms/tmtauthz#authz-aspnet</a>"
    },
    {
      "name": "Enable fine-grained access management to Azure Subscription using RBAC",
      "id": "27",
      "riskReduction": 100,
      "description": "Enable fine-grained access management to Azure Subscription using RBAC. Refer: <a href=\"https://aka.ms/tmtauthz#grained-rbac\">https://aka.ms/tmtauthz#grained-rbac</a>"
    },
    {
      "name": "Ensure that proper exception handling is done in ASP",
      "id": "28",
      "riskReduction": 100,
      "description": "Ensure that proper exception handling is done in ASP.NET Web API. Refer: <a href=\"https://aka.ms/tmtxmgmt#exception\">https://aka.ms/tmtxmgmt#exception</a>"
    },
    {
      "name": "Implement Certificate Pinning",
      "id": "29",
      "riskReduction": 100,
      "description": "Implement Certificate Pinning. Refer: <a href=\"https://aka.ms/tmtcommsec#cert-pinning\">https://aka.ms/tmtcommsec#cert-pinning</a>"
    },
    {
      "name": "Force all traffic to Web APIs over HTTPS connection",
      "id": "30",
      "riskReduction": 100,
      "description": "Force all traffic to Web APIs over HTTPS connection. Refer: <a href=\"https://aka.ms/tmtcommsec#webapi-https\">https://aka.ms/tmtcommsec#webapi-https</a>"
    },
    {
      "name": "Encrypt sensitive or PII data written to phones local storage",
      "id": "31",
      "riskReduction": 100,
      "description": "Encrypt sensitive or PII data written to phones local storage. Refer: <a href=\"https://aka.ms/tmtdata#pii-phones\">https://aka.ms/tmtdata#pii-phones</a>"
    },
    {
      "name": "Encrypt sections of Web API's configuration files that contain sensitive data",
      "id": "32",
      "riskReduction": 100,
      "description": "Encrypt sections of Web API's configuration files that contain sensitive data. Refer: <a href=\"https://aka.ms/tmtconfigmgmt#config-sensitive\">https://aka.ms/tmtconfigmgmt#config-sensitive</a>"
    },
    {
      "name": "Ensure that auditing and logging is enforced on Web API",
      "id": "33",
      "riskReduction": 100,
      "description": "Ensure that auditing and logging is enforced on Web API. Refer: <a href=\"https://aka.ms/tmtauditlog#logging-web-api\">https://aka.ms/tmtauditlog#logging-web-api</a>"
    },
    {
      "name": "Enable fine-grained access management to Azure Subscription using RBAC",
      "id": "34",
      "riskReduction": 100,
      "description": "Enable fine-grained access management to Azure Subscription using RBAC. Refer: <a href=\"https://aka.ms/tmtauthz#grained-rbac\">https://aka.ms/tmtauthz#grained-rbac</a>  Enable Azure Multi-Factor Authentication for Azure Administrators. Refer: <a href=\"https://aka.ms/tmtauthn#multi-factor-azure-admin\">https://aka.ms/tmtauthn#multi-factor-azure-admin</a>"
    },
    {
      "name": "Use ADAL libraries to manage token requests from OAuth2 clients to AAD (or on-premises AD)",
      "id": "35",
      "riskReduction": 100,
      "description": "Use ADAL libraries to manage token requests from OAuth2 clients to AAD (or on-premises AD). Refer: <a href=\"https://aka.ms/tmtauthn#adal-oauth2\">https://aka.ms/tmtauthn#adal-oauth2</a>"
    },
    {
      "name": "Ensure that standard authentication techniques are used to secure Web APIs",
      "id": "36",
      "riskReduction": 100,
      "description": "Ensure that standard authentication techniques are used to secure Web APIs. Refer: <a href=\"https://aka.ms/tmtauthn#authn-secure-api\">https://aka.ms/tmtauthn#authn-secure-api</a>"
    },
    {
      "name": "Ensure that model validation is done on Web API methods",
      "id": "37",
      "riskReduction": 100,
      "description": "Ensure that model validation is done on Web API methods. Refer: <a href=\"https://aka.ms/tmtinputval#validation-api\">https://aka.ms/tmtinputval#validation-api</a>  Implement input validation on all string type parameters accepted by Web API methods. Refer: <a href=\"https://aka.ms/tmtinputval#string-api\">https://aka.ms/tmtinputval#string-api</a>"
    },
    {
      "name": "Obfuscate generated binaries before distributing to end users",
      "id": "38",
      "riskReduction": 100,
      "description": "Obfuscate generated binaries before distributing to end users. Refer: <a href=\"https://aka.ms/tmtdata#binaries-end\">https://aka.ms/tmtdata#binaries-end</a>"
    },
    {
      "name": "Ensure that type-safe parameters are used in Web API for data access",
      "id": "39",
      "riskReduction": 100,
      "description": "Ensure that type-safe parameters are used in Web API for data access. Refer: <a href=\"https://aka.ms/tmtinputval#typesafe-api\">https://aka.ms/tmtinputval#typesafe-api</a>"
    },
    {
      "name": "Enable fine-grained access management to Azure Subscription using RBAC",
      "id": "65",
      "riskReduction": 100,
      "description": "Enable fine-grained access management to Azure Subscription using RBAC. Refer: <a href=\"https://aka.ms/tmtauthz#grained-rbac\">https://aka.ms/tmtauthz#grained-rbac</a>  Enable Azure Multi-Factor Authentication for Azure Administrators. Refer: <a href=\"https://aka.ms/tmtauthn#multi-factor-azure-admin\">https://aka.ms/tmtauthn#multi-factor-azure-admin</a>"
    },
    {
      "name": "Enable fine-grained access management to Azure Subscription using RBAC",
      "id": "64",
      "riskReduction": 100,
      "description": "Enable fine-grained access management to Azure Subscription using RBAC. Refer: <a href=\"https://aka.ms/tmtauthz#grained-rbac\">https://aka.ms/tmtauthz#grained-rbac</a>"
    },
    {
      "name": "Ensure that type-safe parameters are used in Web API for data access",
      "id": "63",
      "riskReduction": 100,
      "description": "Ensure that type-safe parameters are used in Web API for data access. Refer: <a href=\"https://aka.ms/tmtinputval#typesafe-api\">https://aka.ms/tmtinputval#typesafe-api</a>"
    }
  ]
}