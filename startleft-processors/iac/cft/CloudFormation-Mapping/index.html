
<!DOCTYPE html>

<html class="no-js" lang="en">
<head>
<meta charset="utf-8"/>
<meta content="width=device-width,initial-scale=1" name="viewport"/>
<link href="https://iriusrisk.github.io/startleft/startleft-processors/iac/cft/CloudFormation-Mapping/" rel="canonical"/>
<link href="../CloudFormation-Quickstart/" rel="prev"/>
<link href="../CloudFormation-Examples/" rel="next"/>
<link href="../../../../assets/images/favicon.png" rel="icon"/>
<meta content="mkdocs-1.4.2, mkdocs-material-9.0.13" name="generator"/>
<title>CloudFormation Mapping - StartLeft</title>
<link href="../../../../assets/stylesheets/main.ffa9267a.min.css" rel="stylesheet"/>
<link href="../../../../assets/stylesheets/palette.a0c5b2b5.min.css" rel="stylesheet"/>
<link crossorigin="" href="https://fonts.gstatic.com" rel="preconnect"/>
<link href="https://fonts.googleapis.com/css?family=Roboto:300,300i,400,400i,700,700i%7CRoboto+Mono:400,400i,700,700i&amp;display=fallback" rel="stylesheet"/>
<style>:root{--md-text-font:"Roboto";--md-code-font:"Roboto Mono"}</style>
<script>__md_scope=new URL("../../../..",location),__md_hash=e=>[...e].reduce((e,_)=>(e<<5)-e+_.charCodeAt(0),0),__md_get=(e,_=localStorage,t=__md_scope)=>JSON.parse(_.getItem(t.pathname+"."+e)),__md_set=(e,_,t=localStorage,a=__md_scope)=>{try{t.setItem(a.pathname+"."+e,JSON.stringify(_))}catch(e){}}</script>
<link href="../../../../assets/stylesheets/glightbox.min.css" rel="stylesheet"/><style>
            html.glightbox-open { overflow: initial; height: 100%; }
            .gslide-title { margin-top: 0px; user-select: text; }
            .gslide-desc { color: #666; user-select: text; }
            .gslide-image img { background: white; }
            
                .gscrollbar-fixer { padding-right: 15px; }
                .gdesc-inner { font-size: 0.75rem; }
                body[data-md-color-scheme="slate"] .gdesc-inner { background: var(--md-default-bg-color);}
                body[data-md-color-scheme="slate"] .gslide-title { color: var(--md-default-fg-color);}
                body[data-md-color-scheme="slate"] .gslide-desc { color: var(--md-default-fg-color);}
                </style><script src="../../../../assets/javascripts/glightbox.min.js"></script></head>
<body data-md-color-accent="" data-md-color-primary="" data-md-color-scheme="default" dir="ltr">
<script>var palette=__md_get("__palette");if(palette&&"object"==typeof palette.color)for(var key of Object.keys(palette.color))document.body.setAttribute("data-md-color-"+key,palette.color[key])</script>
<input autocomplete="off" class="md-toggle" data-md-toggle="drawer" id="__drawer" type="checkbox"/>
<input autocomplete="off" class="md-toggle" data-md-toggle="search" id="__search" type="checkbox"/>
<label class="md-overlay" for="__drawer"></label>
<div data-md-component="skip">
<a class="md-skip" href="#cloudformation-mapping">
          Skip to content
        </a>
</div>
<div data-md-component="announce">
</div>
<header class="md-header" data-md-component="header">
<nav aria-label="Header" class="md-header__inner md-grid">
<a aria-label="StartLeft" class="md-header__button md-logo" data-md-component="logo" href="../../../.." title="StartLeft">
<svg viewbox="0 0 24 24" xmlns="http://www.w3.org/2000/svg"><path d="M12 8a3 3 0 0 0 3-3 3 3 0 0 0-3-3 3 3 0 0 0-3 3 3 3 0 0 0 3 3m0 3.54C9.64 9.35 6.5 8 3 8v11c3.5 0 6.64 1.35 9 3.54 2.36-2.19 5.5-3.54 9-3.54V8c-3.5 0-6.64 1.35-9 3.54Z"></path></svg>
</a>
<label class="md-header__button md-icon" for="__drawer">
<svg viewbox="0 0 24 24" xmlns="http://www.w3.org/2000/svg"><path d="M3 6h18v2H3V6m0 5h18v2H3v-2m0 5h18v2H3v-2Z"></path></svg>
</label>
<div class="md-header__title" data-md-component="header-title">
<div class="md-header__ellipsis">
<div class="md-header__topic">
<span class="md-ellipsis">
            StartLeft
          </span>
</div>
<div class="md-header__topic" data-md-component="header-topic">
<span class="md-ellipsis">
            
              CloudFormation Mapping
            
          </span>
</div>
</div>
</div>
<form class="md-header__option" data-md-component="palette">
<input aria-label="Switch to dark mode" class="md-option" data-md-color-accent="" data-md-color-media="(prefers-color-scheme: light)" data-md-color-primary="" data-md-color-scheme="default" id="__palette_1" name="__palette" type="radio"/>
<label class="md-header__button md-icon" for="__palette_2" hidden="" title="Switch to dark mode">
<svg viewbox="0 0 24 24" xmlns="http://www.w3.org/2000/svg"><path d="M12 8a4 4 0 0 0-4 4 4 4 0 0 0 4 4 4 4 0 0 0 4-4 4 4 0 0 0-4-4m0 10a6 6 0 0 1-6-6 6 6 0 0 1 6-6 6 6 0 0 1 6 6 6 6 0 0 1-6 6m8-9.31V4h-4.69L12 .69 8.69 4H4v4.69L.69 12 4 15.31V20h4.69L12 23.31 15.31 20H20v-4.69L23.31 12 20 8.69Z"></path></svg>
</label>
<input aria-label="Switch to light mode" class="md-option" data-md-color-accent="" data-md-color-media="(prefers-color-scheme: dark)" data-md-color-primary="" data-md-color-scheme="slate" id="__palette_2" name="__palette" type="radio"/>
<label class="md-header__button md-icon" for="__palette_1" hidden="" title="Switch to light mode">
<svg viewbox="0 0 24 24" xmlns="http://www.w3.org/2000/svg"><path d="M12 18c-.89 0-1.74-.2-2.5-.55C11.56 16.5 13 14.42 13 12c0-2.42-1.44-4.5-3.5-5.45C10.26 6.2 11.11 6 12 6a6 6 0 0 1 6 6 6 6 0 0 1-6 6m8-9.31V4h-4.69L12 .69 8.69 4H4v4.69L.69 12 4 15.31V20h4.69L12 23.31 15.31 20H20v-4.69L23.31 12 20 8.69Z"></path></svg>
</label>
</form>
<label class="md-header__button md-icon" for="__search">
<svg viewbox="0 0 24 24" xmlns="http://www.w3.org/2000/svg"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.516 6.516 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5Z"></path></svg>
</label>
<div class="md-search" data-md-component="search" role="dialog">
<label class="md-search__overlay" for="__search"></label>
<div class="md-search__inner" role="search">
<form class="md-search__form" name="search">
<input aria-label="Search" autocapitalize="off" autocomplete="off" autocorrect="off" class="md-search__input" data-md-component="search-query" name="query" placeholder="Search" required="" spellcheck="false" type="text"/>
<label class="md-search__icon md-icon" for="__search">
<svg viewbox="0 0 24 24" xmlns="http://www.w3.org/2000/svg"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.516 6.516 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5Z"></path></svg>
<svg viewbox="0 0 24 24" xmlns="http://www.w3.org/2000/svg"><path d="M20 11v2H8l5.5 5.5-1.42 1.42L4.16 12l7.92-7.92L13.5 5.5 8 11h12Z"></path></svg>
</label>
<nav aria-label="Search" class="md-search__options">
<button aria-label="Clear" class="md-search__icon md-icon" tabindex="-1" title="Clear" type="reset">
<svg viewbox="0 0 24 24" xmlns="http://www.w3.org/2000/svg"><path d="M19 6.41 17.59 5 12 10.59 6.41 5 5 6.41 10.59 12 5 17.59 6.41 19 12 13.41 17.59 19 19 17.59 13.41 12 19 6.41Z"></path></svg>
</button>
</nav>
<div class="md-search__suggest" data-md-component="search-suggest"></div>
</form>
<div class="md-search__output">
<div class="md-search__scrollwrap" data-md-scrollfix="">
<div class="md-search-result" data-md-component="search-result">
<div class="md-search-result__meta">
            Initializing search
          </div>
<ol class="md-search-result__list" role="presentation"></ol>
</div>
</div>
</div>
</div>
</div>
<div class="md-header__source">
<a class="md-source" data-md-component="source" href="https://github.com/iriusrisk/startleft" title="Go to repository">
<div class="md-source__icon md-icon">
<svg viewbox="0 0 448 512" xmlns="http://www.w3.org/2000/svg"><!--! Font Awesome Free 6.3.0 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2023 Fonticons, Inc.--><path d="M439.55 236.05 244 40.45a28.87 28.87 0 0 0-40.81 0l-40.66 40.63 51.52 51.52c27.06-9.14 52.68 16.77 43.39 43.68l49.66 49.66c34.23-11.8 61.18 31 35.47 56.69-26.49 26.49-70.21-2.87-56-37.34L240.22 199v121.85c25.3 12.54 22.26 41.85 9.08 55a34.34 34.34 0 0 1-48.55 0c-17.57-17.6-11.07-46.91 11.25-56v-123c-20.8-8.51-24.6-30.74-18.64-45L142.57 101 8.45 235.14a28.86 28.86 0 0 0 0 40.81l195.61 195.6a28.86 28.86 0 0 0 40.8 0l194.69-194.69a28.86 28.86 0 0 0 0-40.81z"></path></svg>
</div>
<div class="md-source__repository">
    GitHub
  </div>
</a>
</div>
</nav>
</header>
<div class="md-container" data-md-component="container">
<main class="md-main" data-md-component="main">
<div class="md-main__inner md-grid">
<div class="md-sidebar md-sidebar--primary" data-md-component="sidebar" data-md-type="navigation">
<div class="md-sidebar__scrollwrap">
<div class="md-sidebar__inner">
<nav aria-label="Navigation" class="md-nav md-nav--primary" data-md-level="0">
<label class="md-nav__title" for="__drawer">
<a aria-label="StartLeft" class="md-nav__button md-logo" data-md-component="logo" href="../../../.." title="StartLeft">
<svg viewbox="0 0 24 24" xmlns="http://www.w3.org/2000/svg"><path d="M12 8a3 3 0 0 0 3-3 3 3 0 0 0-3-3 3 3 0 0 0-3 3 3 3 0 0 0 3 3m0 3.54C9.64 9.35 6.5 8 3 8v11c3.5 0 6.64 1.35 9 3.54 2.36-2.19 5.5-3.54 9-3.54V8c-3.5 0-6.64 1.35-9 3.54Z"></path></svg>
</a>
    StartLeft
  </label>
<div class="md-nav__source">
<a class="md-source" data-md-component="source" href="https://github.com/iriusrisk/startleft" title="Go to repository">
<div class="md-source__icon md-icon">
<svg viewbox="0 0 448 512" xmlns="http://www.w3.org/2000/svg"><!--! Font Awesome Free 6.3.0 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2023 Fonticons, Inc.--><path d="M439.55 236.05 244 40.45a28.87 28.87 0 0 0-40.81 0l-40.66 40.63 51.52 51.52c27.06-9.14 52.68 16.77 43.39 43.68l49.66 49.66c34.23-11.8 61.18 31 35.47 56.69-26.49 26.49-70.21-2.87-56-37.34L240.22 199v121.85c25.3 12.54 22.26 41.85 9.08 55a34.34 34.34 0 0 1-48.55 0c-17.57-17.6-11.07-46.91 11.25-56v-123c-20.8-8.51-24.6-30.74-18.64-45L142.57 101 8.45 235.14a28.86 28.86 0 0 0 0 40.81l195.61 195.6a28.86 28.86 0 0 0 40.8 0l194.69-194.69a28.86 28.86 0 0 0 0-40.81z"></path></svg>
</div>
<div class="md-source__repository">
    GitHub
  </div>
</a>
</div>
<ul class="md-nav__list" data-md-scrollfix="">
<li class="md-nav__item">
<a class="md-nav__link" href="../../../..">
        Home
      </a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="../../../../Open-Threat-Model-%28OTM%29/">
        Open Threat Model (OTM)
      </a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="../../../../Quickstart-Guide-for-Beginners/">
        Quickstart Guide for Beginners
      </a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="../../../../About/">
        About this documentation
      </a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="../../../../Versioning/">
        Versioning
      </a>
</li>
<li class="md-nav__item md-nav__item--nested">
<input class="md-nav__toggle md-toggle" id="__nav_6" type="checkbox"/>
<label class="md-nav__link" for="__nav_6" id="__nav_6_label" tabindex="0">
          Usage
          <span class="md-nav__icon md-icon"></span>
</label>
<nav aria-expanded="false" aria-labelledby="__nav_6_label" class="md-nav" data-md-level="1">
<label class="md-nav__title" for="__nav_6">
<span class="md-nav__icon md-icon"></span>
          Usage
        </label>
<ul class="md-nav__list" data-md-scrollfix="">
<li class="md-nav__item">
<a class="md-nav__link" href="../../../../usage/Command-Line-Interface/">
        Command Line Interface (CLI)
      </a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="../../../../usage/REST-API/">
        REST API
      </a>
</li>
</ul>
</nav>
</li>
<li class="md-nav__item md-nav__item--nested">
<input class="md-nav__toggle md-toggle" id="__nav_7" type="checkbox"/>
<label class="md-nav__link" for="__nav_7" id="__nav_7_label" tabindex="0">
          Guide for Integrations
          <span class="md-nav__icon md-icon"></span>
</label>
<nav aria-expanded="false" aria-labelledby="__nav_7_label" class="md-nav" data-md-level="1">
<label class="md-nav__title" for="__nav_7">
<span class="md-nav__icon md-icon"></span>
          Guide for Integrations
        </label>
<ul class="md-nav__list" data-md-scrollfix="">
<li class="md-nav__item">
<a class="md-nav__link" href="../../../../integration/Quickstart-Guide-for-Integrations/">
        Quickstart Guide for Integrations
      </a>
</li>
</ul>
</nav>
</li>
<li class="md-nav__item md-nav__item--nested">
<input class="md-nav__toggle md-toggle" id="__nav_8" type="checkbox"/>
<label class="md-nav__link" for="__nav_8" id="__nav_8_label" tabindex="0">
          Guide for Developers
          <span class="md-nav__icon md-icon"></span>
</label>
<nav aria-expanded="false" aria-labelledby="__nav_8_label" class="md-nav" data-md-level="1">
<label class="md-nav__title" for="__nav_8">
<span class="md-nav__icon md-icon"></span>
          Guide for Developers
        </label>
<ul class="md-nav__list" data-md-scrollfix="">
<li class="md-nav__item">
<a class="md-nav__link" href="../../../../development/Quickstart-Guide-for-Developers/">
        Quickstart Guide for Developers
      </a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="../../../../development/Create-a-new-StartLeft-Processor/">
        Create a new SLP
      </a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="../../../../development/Architecture/">
        Architecture
      </a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="../../../../development/Errors-Management/">
        Errors management
      </a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="../../../../development/Run-Configurations/">
        Run Configurations
      </a>
</li>
</ul>
</nav>
</li>
<li class="md-nav__item md-nav__item--active md-nav__item--nested">
<input checked="" class="md-nav__toggle md-toggle" id="__nav_9" type="checkbox"/>
<label class="md-nav__link" for="__nav_9" id="__nav_9_label" tabindex="0">
          StartLeft Processors (SLP)
          <span class="md-nav__icon md-icon"></span>
</label>
<nav aria-expanded="true" aria-labelledby="__nav_9_label" class="md-nav" data-md-level="1">
<label class="md-nav__title" for="__nav_9">
<span class="md-nav__icon md-icon"></span>
          StartLeft Processors (SLP)
        </label>
<ul class="md-nav__list" data-md-scrollfix="">
<li class="md-nav__item md-nav__item--nested">
<input class="md-nav__toggle md-toggle" id="__nav_9_1" type="checkbox"/>
<label class="md-nav__link" for="__nav_9_1" id="__nav_9_1_label" tabindex="0">
          Microsoft Threat Modeling Tool (MTMT)
          <span class="md-nav__icon md-icon"></span>
</label>
<nav aria-expanded="false" aria-labelledby="__nav_9_1_label" class="md-nav" data-md-level="2">
<label class="md-nav__title" for="__nav_9_1">
<span class="md-nav__icon md-icon"></span>
          Microsoft Threat Modeling Tool (MTMT)
        </label>
<ul class="md-nav__list" data-md-scrollfix="">
<li class="md-nav__item">
<a class="md-nav__link" href="../../../external-threat-model/mtmt/MTMT-Quickstart/">
        MTMT Quickstart
      </a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="../../../external-threat-model/mtmt/MTMT-Mapping/">
        MTMT Mapping
      </a>
</li>
</ul>
</nav>
</li>
<li class="md-nav__item md-nav__item--active md-nav__item--nested">
<input checked="" class="md-nav__toggle md-toggle" id="__nav_9_2" type="checkbox"/>
<label class="md-nav__link" for="__nav_9_2" id="__nav_9_2_label" tabindex="0">
          CloudFormation Template
          <span class="md-nav__icon md-icon"></span>
</label>
<nav aria-expanded="true" aria-labelledby="__nav_9_2_label" class="md-nav" data-md-level="2">
<label class="md-nav__title" for="__nav_9_2">
<span class="md-nav__icon md-icon"></span>
          CloudFormation Template
        </label>
<ul class="md-nav__list" data-md-scrollfix="">
<li class="md-nav__item">
<a class="md-nav__link" href="../CloudFormation-Quickstart/">
        CloudFormation Quickstart
      </a>
</li>
<li class="md-nav__item md-nav__item--active">
<input class="md-nav__toggle md-toggle" id="__toc" type="checkbox"/>
<label class="md-nav__link md-nav__link--active" for="__toc">
          CloudFormation Mapping
          <span class="md-nav__icon md-icon"></span>
</label>
<a class="md-nav__link md-nav__link--active" href="./">
        CloudFormation Mapping
      </a>
<nav aria-label="Table of contents" class="md-nav md-nav--secondary">
<label class="md-nav__title" for="__toc">
<span class="md-nav__icon md-icon"></span>
      Table of contents
    </label>
<ul class="md-nav__list" data-md-component="toc" data-md-scrollfix="">
<li class="md-nav__item">
<a class="md-nav__link" href="#jmespath-queries">
    JMESPath Queries
  </a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="#hardcoded-values">
    Hardcoded values
  </a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="#lookup-table">
    Lookup table
  </a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="#additional-jmespath-functions">
    Additional JMESPath functions
  </a>
<nav aria-label="Additional JMESPath functions" class="md-nav">
<ul class="md-nav__list">
<li class="md-nav__item">
<a class="md-nav__link" href="#re_sub">
    re_sub
  </a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="#squash">
    squash
  </a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="#tail">
    tail
  </a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="#get_starts_with">
    get_starts_with
  </a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="#split">
    split
  </a>
</li>
</ul>
</nav>
</li>
</ul>
</nav>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="../CloudFormation-Examples/">
        CloudFormation Examples
      </a>
</li>
</ul>
</nav>
</li>
<li class="md-nav__item md-nav__item--nested">
<input class="md-nav__toggle md-toggle" id="__nav_9_3" type="checkbox"/>
<label class="md-nav__link" for="__nav_9_3" id="__nav_9_3_label" tabindex="0">
          Terraform
          <span class="md-nav__icon md-icon"></span>
</label>
<nav aria-expanded="false" aria-labelledby="__nav_9_3_label" class="md-nav" data-md-level="2">
<label class="md-nav__title" for="__nav_9_3">
<span class="md-nav__icon md-icon"></span>
          Terraform
        </label>
<ul class="md-nav__list" data-md-scrollfix="">
<li class="md-nav__item">
<a class="md-nav__link" href="../../tf/Terraform-Quickstart/">
        Terraform Quickstart
      </a>
</li>
<li class="md-nav__item md-nav__item--nested">
<input class="md-nav__toggle md-toggle" id="__nav_9_3_2" type="checkbox"/>
<label class="md-nav__link" for="__nav_9_3_2" id="__nav_9_3_2_label" tabindex="0">
          Terraform Mapping
          <span class="md-nav__icon md-icon"></span>
</label>
<nav aria-expanded="false" aria-labelledby="__nav_9_3_2_label" class="md-nav" data-md-level="3">
<label class="md-nav__title" for="__nav_9_3_2">
<span class="md-nav__icon md-icon"></span>
          Terraform Mapping
        </label>
<ul class="md-nav__list" data-md-scrollfix="">
<li class="md-nav__item">
<a class="md-nav__link" href="../../tf/Terraform-how-to-create-a-basic-mapping-file/">
        How To Create a Basic Mapping File
      </a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="../../tf/Terraform-how-mapping-file-works/">
        How Mapping File works
      </a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="../../tf/Terraform-how-dataflow-mapping-works/">
        How Dataflow Mapping File works
      </a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="../../tf/Terraform-domain-specific-language/">
        Domain-Specific Language
      </a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="../../tf/Terraform-additional-jmespath-functions/">
        Additional JMESPath functions
      </a>
</li>
</ul>
</nav>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="../../tf/Terraform-Examples/">
        Terraform Examples
      </a>
</li>
</ul>
</nav>
</li>
<li class="md-nav__item md-nav__item--nested">
<input class="md-nav__toggle md-toggle" id="__nav_9_4" type="checkbox"/>
<label class="md-nav__link" for="__nav_9_4" id="__nav_9_4_label" tabindex="0">
          Visio
          <span class="md-nav__icon md-icon"></span>
</label>
<nav aria-expanded="false" aria-labelledby="__nav_9_4_label" class="md-nav" data-md-level="2">
<label class="md-nav__title" for="__nav_9_4">
<span class="md-nav__icon md-icon"></span>
          Visio
        </label>
<ul class="md-nav__list" data-md-scrollfix="">
<li class="md-nav__item">
<a class="md-nav__link" href="../../../diagram/Visio-Quickstart/">
        Visio Quickstart
      </a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="../../../diagram/Visio-Mapping/">
        Visio Mapping
      </a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="../../../diagram/Visio-TrustZones-Mapping/">
        Visio TrustZones Mapping
      </a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="../../../diagram/Visio-Representations/">
        Visio Representations
      </a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="../../../diagram/Lucidchart-support/">
        Lucidchart Support
      </a>
</li>
</ul>
</nav>
</li>
</ul>
</nav>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="../../../../Troubleshooting/">
        Troubleshooting
      </a>
</li>
</ul>
</nav>
</div>
</div>
</div>
<div class="md-sidebar md-sidebar--secondary" data-md-component="sidebar" data-md-type="toc">
<div class="md-sidebar__scrollwrap">
<div class="md-sidebar__inner">
<nav aria-label="Table of contents" class="md-nav md-nav--secondary">
<label class="md-nav__title" for="__toc">
<span class="md-nav__icon md-icon"></span>
      Table of contents
    </label>
<ul class="md-nav__list" data-md-component="toc" data-md-scrollfix="">
<li class="md-nav__item">
<a class="md-nav__link" href="#jmespath-queries">
    JMESPath Queries
  </a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="#hardcoded-values">
    Hardcoded values
  </a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="#lookup-table">
    Lookup table
  </a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="#additional-jmespath-functions">
    Additional JMESPath functions
  </a>
<nav aria-label="Additional JMESPath functions" class="md-nav">
<ul class="md-nav__list">
<li class="md-nav__item">
<a class="md-nav__link" href="#re_sub">
    re_sub
  </a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="#squash">
    squash
  </a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="#tail">
    tail
  </a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="#get_starts_with">
    get_starts_with
  </a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="#split">
    split
  </a>
</li>
</ul>
</nav>
</li>
</ul>
</nav>
</div>
</div>
</div>
<div class="md-content" data-md-component="content">
<article class="md-content__inner md-typeset">
<h1 id="cloudformation-mapping">CloudFormation mapping</h1>
<p>A source mapping file (or "mapping files" for short) describes how to find components, dataflows, and trustzones in source file data structures.</p>
<p>To accomplish this, a mapping file contains additional logic around a collection of JMESPath queries which are used.
Also, some exclusive StartLeft actions based on JMESPath may be used in mapping files to solve the most complex mappings.</p>
<p>Source mapping files are made up of three main sections corresponding to the main sections in an OTM file, plus an optional lookup section described below:</p>
<ul>
<li>trustzones</li>
<li>components</li>
<li>dataflows</li>
</ul>
<p>Each contains a list of 0 or more objects that describe how to find the respective object in the source file, and each object has a number of required and optional fields. </p>
<p>Take a look at the <a href="https://github.com/iriusrisk/startleft/blob/main/slp_cft/resources/schemas/iac_cft_mapping_schema.json">JSONSchema</a> file for more details.</p>
<h2 id="jmespath-queries">JMESPath Queries</h2>
<hr/>
<p>Special $action fields begin with a dollar sign ($) and do not directly contribute to the OTM output. Instead, they specify an action and behaviour used to process the source files or generate the OTM output. </p>
<p>This table describes each special $actions:</p>
<table>
<thead>
<tr>
<th>$action</th>
<th>Description</th>
<th>Example</th>
</tr>
</thead>
<tbody>
<tr>
<td>$source</td>
<td>Specifies the source of the object type</td>
<td _resources_wzxhzdk:46_squash_type='"Resources|squash(@)[?Type' _root:="$root:">$source:</td>
</tr>
<tr>
<td>$root</td>
<td>JMESPath search through the entire source file data structure</td>
<td>$root: "Resources|squash(@)[?Type=='AWS::EC2::VPC']"</td>
</tr>
<tr>
<td>$path</td>
<td>JMESPath search through the object identified in the $source. A default value is optional by using the $searchParams structure</td>
<td>$path: "Type" <br/>$path: "Properties.VpcId.Ref"<br/>$path: {$searchParams:{ searchPath: "Properties.SubnetId.Ref", defaultValue: "b61d6911-338d-46a8-9f39-8dcd24abfe91"}}</td>
</tr>
<tr>
<td>$findFirst</td>
<td>JMESPath search through the list of objects identified in the $source and returning the first successful match. A default value is optional by using the $searchParams structure</td>
<td>$findFirst: ["Properties.FunctionName.Ref", "Properties.FunctionName"] <br/> $findFirst: {$searchParams:{ searchPath: ["Properties.SubnetId.Ref","Properties.SubnetId"], defaultValue: "b61d6911-338d-46a8-9f39-8dcd24abfe91"}}</td>
</tr>
<tr>
<td>$format</td>
<td>A named format string based on the output of other $special fields. Note, only to be used for id fields.</td>
<td>$format: "{name}"</td>
</tr>
<tr>
<td>$catchall</td>
<td>A sub-field of $source, specifying a default search for all other objects not explicitly defined</td>
<td _resources_wzxhzdk:41_squash_='"Resources|squash(@)"' _root:="$root:">$catchall:</td>
</tr>
<tr>
<td>$skip</td>
<td>A sub-field of $source, specifying specific objects to skip if not explicitly defined</td>
<td _resources_wzxhzdk:40_squash_type='"Resources|squash(@)[?Type' _root:="$root:">$skip:</td>
</tr>
<tr>
<td>$singleton</td>
<td>A sub-field of $source, specifying specific objects to be unified under a single component or trustzone</td>
<td _resources_wzxhzdk:39_squash_type='"Resources|squash(@)[?Type' _root:="$root:">$singleton:</td>
</tr>
<tr>
<td>$numberOfSources</td>
<td>When using singleton, allows you to set different values for output name or tags when the number of sources for the same mapping are single or multiple</td>
<td>$numberOfSources: {oneSource:{$path: "_key"}, multipleSource:{ $format: "CD-ACM (grouped)" }}</td>
</tr>
<tr>
<td>$altsource</td>
<td>Specifies an alternative mapping when $source returns no object.</td>
<td>$altsource:<br/>       - $mappingType: {$root: "Resources|squash(@)[?Type=='AWS::EC2::VPCEndpoint']"}<br/>         $mappingPath: {$path: "Properties.ServiceName"}<br/>         $mappingLookups:<br/>           - regex: ^(.*)s3$<br/>             name: S3 from VPCEndpoint<br/>             type: s3</td>
</tr>
<tr>
<td>$lookup</td>
<td>Allows you to look up the output of a $special field against a key-value lookup table</td>
<td _='@)"' _-_="'-'," _properties.subnets_wzxhzdk:30_map_values_='"Properties.Subnets[]|map(&amp;values(@),' _wzxhzdk:31_map_re_sub_:_="@)[]|map(&amp;re_sub('[:]'," path:="path:">$lookup:</td>
</tr>
<tr>
<td>$hub</td>
<td>Only for dataflow's "source" and "destination" fields. Especially created for building dataflows from Security Group structures without generating components from them. Allows to define abstract contact points for larger end-to-end final dataflows</td>
<td>destination: {$hub: {$path: "Properties.GroupId"}}</td>
</tr>
<tr>
<td>$ip</td>
<td>When defining a component's "name" field as $ip, will generate a singleton component for representing an external IP but without limitations of singleton for this case, so the "type" for the defined mapping definition with $ip (i.e. generic-terminal) will not be catalogued as singleton.</td>
<td>name: { $ip: { $path: "Properties.SecurityGroupEgress[0].CidrIp" } }</td>
</tr>
</tbody>
</table>
<p>For more information on how to create a JMESPath search query, check out the <a href="https://jmespath.org/">website</a>.</p>
<h2 id="hardcoded-values">Hardcoded values</h2>
<hr/>
<p>In addition to using $source and other special $actions, you can also just hardcode values which will be taken and mapped as is. For example, you may want to specify a default trustzone which wouldn't be found anywhere in the source files. You can do this easily just by adding it to a mapping file:</p>
<p><div class="highlight"><pre><span></span><code><a href="#__codelineno-0-1" id="__codelineno-0-1" name="__codelineno-0-1"></a>trustzones:
<a href="#__codelineno-0-2" id="__codelineno-0-2" name="__codelineno-0-2"></a>  - id:   tz1
<a href="#__codelineno-0-3" id="__codelineno-0-3" name="__codelineno-0-3"></a>    name: Default
<a href="#__codelineno-0-4" id="__codelineno-0-4" name="__codelineno-0-4"></a>    type: default-zone
</code></pre></div>
The <code>id</code> field uniquely identifies a trustzone, and differentiates it from other trustzones of the same type.</p>
<p>For mapping trustzones to IriusRisk trustzones, <code>type</code> field must take internal IriusRisk values depending on the type of trustzone.
These values are defined in the internal CloudFormation mapping file.</p>
<blockquote>
<p>For the purpose of preserving backwards compatibility, StartLeft also accepts the legacy mapping file format.
In this format, there is no <code>type</code> field and the <code>id</code> will be used as both, ID and type.</p>
<p>It is not possible to have multiple trustzones of the same type when using this format.</p>
</blockquote>
<h2 id="lookup-table">Lookup table</h2>
<hr/>
<p>Just in case there are some inconsistencies in naming conventions used, and you need to be able to translate one name into another, a simple lookup key-value table section can be added to the mapping file.</p>
<p>For example, if we have a situation where a subnet name is written using a short naming convention, but is actually referred to via a longer name elsewhere, we can use the $lookup action.</p>
<div class="highlight"><pre><span></span><code><a href="#__codelineno-1-1" id="__codelineno-1-1" name="__codelineno-1-1"></a>parent:
<a href="#__codelineno-1-2" id="__codelineno-1-2" name="__codelineno-1-2"></a>  $lookup: {$path: "Properties.Subnets[]|map(&amp;values(@), @)[]|map(&amp;re_sub('[:]', '-', @), @)"}
</code></pre></div>
<p>If the above query returns a subnet called <code>shortnameA</code>, then it will be looked up in the below table:</p>
<div class="highlight"><pre><span></span><code><a href="#__codelineno-2-1" id="__codelineno-2-1" name="__codelineno-2-1"></a>lookup:
<a href="#__codelineno-2-2" id="__codelineno-2-2" name="__codelineno-2-2"></a>  shortnameA: amuchlongernameA
<a href="#__codelineno-2-3" id="__codelineno-2-3" name="__codelineno-2-3"></a>  shortnameB: amuchlongernameB
</code></pre></div>
<p>To give a final value of <code>amuchlongernameA</code>.</p>
<h2 id="additional-jmespath-functions">Additional JMESPath functions</h2>
<hr/>
<p>Parsing of IaC files may be sometimes complex, so that the built-in JMESPath described above are not enough. For those cases,
a set of custom functions has been created to simplify and make more powerful the creation of mapping files.</p>
<h3 id="re_sub">re_sub</h3>
<p>The <code>re_sub</code> function replaces the occurrences of <code>pattern</code> with <code>replace</code> in the given <code>string</code>. </p>
<div class="highlight"><pre><span></span><code><a href="#__codelineno-3-1" id="__codelineno-3-1" name="__codelineno-3-1"></a><span class="k">def</span> <span class="nf">_func_re_sub</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">pattern</span><span class="p">,</span> <span class="n">replace</span><span class="p">,</span> <span class="n">origin_string</span><span class="p">)</span>
</code></pre></div>
<p>For example, we may want to replace colon characters with hyphens such as in <code>re_sub('[:]', '-', 'stack:subnet')</code>.</p>
<h3 id="squash">squash</h3>
<p>The <code>squash</code> function takes a nested object of objects, and squashes them into a list of objects, injecting the parent "key" to the child object as "_key".</p>
<div class="highlight"><pre><span></span><code><a href="#__codelineno-4-1" id="__codelineno-4-1" name="__codelineno-4-1"></a><span class="k">def</span> <span class="nf">_func_squash</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">obj</span><span class="p">)</span>
</code></pre></div>
<p>This function is specially useful for Cloudformation mapping files. These have a root <code>Resources</code> object whose 
top level keys are the resource names which have the resource objects as values. This structure is hard to iterate over 
without losing the important name key. So you can use squash and refer to the name through the <code>_key</code> field. </p>
<div class="highlight"><pre><span></span><code><a href="#__codelineno-5-1" id="__codelineno-5-1" name="__codelineno-5-1"></a><span class="nt">name</span><span class="p">:</span><span class="w">    </span><span class="p p-Indicator">{</span><span class="nt">$path</span><span class="p">:</span><span class="w"> </span><span class="s">"_key"</span><span class="p p-Indicator">}</span>
<a href="#__codelineno-5-2" id="__codelineno-5-2" name="__codelineno-5-2"></a><span class="nt">$source</span><span class="p">:</span><span class="w"> </span><span class="p p-Indicator">{</span><span class="nt">$root</span><span class="p">:</span><span class="w"> </span><span class="s">"Resources|squash(@)[?Type=='AWS::EC2::Subnet']"</span><span class="p p-Indicator">}</span>
</code></pre></div>
<h3 id="tail">tail</h3>
<p>The <code>tail</code> function returns the characters of a given <code>string</code> from the <code>count</code> index onwards. It is equivalent to
python's <code>string[count:]</code>.</p>
<div class="highlight"><pre><span></span><code><a href="#__codelineno-6-1" id="__codelineno-6-1" name="__codelineno-6-1"></a><span class="k">def</span> <span class="nf">_func_tail</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">string</span><span class="p">,</span> <span class="n">count</span><span class="p">)</span>
</code></pre></div>
<h3 id="get_starts_with">get_starts_with</h3>
<p>This function is equivalent to <code>get</code>, but instead of using the <code>component_type</code> argument to perform an exact filter, the
target component type must start with it.</p>
<div class="highlight"><pre><span></span><code><a href="#__codelineno-7-1" id="__codelineno-7-1" name="__codelineno-7-1"></a><span class="k">def</span> <span class="nf">_func_get_starts_with</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">obj_arr</span><span class="p">,</span> <span class="n">component_type</span><span class="p">)</span>
</code></pre></div>
<h3 id="split">split</h3>
<p>The <code>split</code> function is the equivalent to the python's one. It breaks a given string based on a given separator and
returns the resulting array of strings. It is equivalent to python's <code>split</code> function.</p>
</article>
</div>
<script>var tabs=__md_get("__tabs");if(Array.isArray(tabs))e:for(var set of document.querySelectorAll(".tabbed-set")){var tab,labels=set.querySelector(".tabbed-labels");for(tab of tabs)for(var label of labels.getElementsByTagName("label"))if(label.innerText.trim()===tab){var input=document.getElementById(label.htmlFor);input.checked=!0;continue e}}</script>
</div>
</main>
<footer class="md-footer">
<div class="md-footer-meta md-typeset">
<div class="md-footer-meta__inner md-grid">
<div class="md-copyright">
  
  
    Made with
    <a href="https://squidfunk.github.io/mkdocs-material/" rel="noopener" target="_blank">
      Material for MkDocs
    </a>
</div>
</div>
</div>
</footer>
</div>
<div class="md-dialog" data-md-component="dialog">
<div class="md-dialog__inner md-typeset"></div>
</div>
<div class="md-consent" data-md-component="consent" hidden="" id="__consent">
<div class="md-consent__overlay"></div>
<aside class="md-consent__inner">
<form class="md-consent__form md-grid md-typeset" name="consent">
<h4>Cookie consent</h4>
<p>We use cookies to recognize your repeated visits and preferences, as well as to measure the effectiveness of our documentation and whether users find what they're searching for. With your consent, you're helping us to make our documentation better.</p>
<input class="md-toggle" id="__settings" type="checkbox"/>
<div class="md-consent__settings">
<ul class="task-list">
<li class="task-list-item">
<label class="task-list-control">
<input checked="" name="github" type="checkbox"/>
<span class="task-list-indicator"></span>
          GitHub
        </label>
</li>
</ul>
</div>
<div class="md-consent__controls">
<button class="md-button md-button--primary">Accept</button>
<label class="md-button" for="__settings">Manage settings</label>
</div>
</form>
</aside>
</div>
<script>var consent=__md_get("__consent");if(consent)for(var input of document.forms.consent.elements)input.name&&(input.checked=consent[input.name]||!1);else"file:"!==location.protocol&&setTimeout(function(){document.querySelector("[data-md-component=consent]").hidden=!1},250);var action,form=document.forms.consent;for(action of["submit","reset"])form.addEventListener(action,function(e){if(e.preventDefault(),"reset"===e.type)for(var n of document.forms.consent.elements)n.name&&(n.checked=!1);__md_set("__consent",Object.fromEntries(Array.from(new FormData(form).keys()).map(function(e){return[e,!0]}))),location.hash="",location.reload()})</script>
<script id="__config" type="application/json">{"base": "../../../..", "features": ["navigation.instant", "navigation.tracking", "search.suggest", "search.highlight", "content.code.annotate", "content.tabs.link"], "search": "../../../../assets/javascripts/workers/search.208ed371.min.js", "translations": {"clipboard.copied": "Copied to clipboard", "clipboard.copy": "Copy to clipboard", "search.result.more.one": "1 more on this page", "search.result.more.other": "# more on this page", "search.result.none": "No matching documents", "search.result.one": "1 matching document", "search.result.other": "# matching documents", "search.result.placeholder": "Type to start searching", "search.result.term.missing": "Missing", "select.version": "Select version"}}</script>
<script src="../../../../assets/javascripts/bundle.2a6f1dda.min.js"></script>
<script>document$.subscribe(() => {const lightbox = GLightbox({"touchNavigation": true, "loop": false, "zoomable": true, "draggable": true, "openEffect": "zoom", "closeEffect": "zoom", "slideEffect": "slide"});})</script></body>
</html>